<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
		xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorator="admin/common/templateAdmin">
<head>
<meta charset="UTF-8" />
<link th:href="@{/templateAdmin/css/multiple-image-preview.css}" rel="stylesheet" />
<title>Thêm Sản Phẩm</title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
<script src="https://cdn.tiny.cloud/1/2mxsxulxmdqvlr9jnx0cii9sz96jwsyqbahtu3gars8e7kp6/tinymce/5/tinymce.min.js" referrerpolicy="origin"></script>
<script>
      tinymce.init({
        selector: '#mytextarea'
      });
</script>
</head>
<body>
	<section layout:fragment="content">
		<div class="container">
			<div class="row">
				<div class="col-12">
<<<<<<< HEAD
					<form th:action="@{/admin/san-pham/them-moi-san-pham}" th:object="${Sach}" enctype="multipart/form-data" method="POST">
=======
					<form th:action="@{/them-moi-san-pham}" th:object="${Sach}" enctype="multipart/form-data" method="POST" id="form" class="form">
>>>>>>> 077bd355df12fa91e1f00464001cf197e7215f0d
					<div class="text-center bold text-center mb-4">
						<h3>Thêm sản phẩm</h3>
					</div>
					<div class="mb-3 row">
					    <label for="name" class="col-sm-2 col-form-label">Tên sách</label>
					    <div class="col-sm-10">
					      <input type="text" th:field="*{tenSach}" class="form-control" id="name">
					      <span class="text-danger" th:errors="*{tenSach}"></span>
					    </div>
				  	</div>
					<div class="mb-3 row">
					    <label for="price" class="col-sm-2 col-form-label">Giá</label>
					    <div class="col-sm-10">
					      <input type="number" min="0" th:field="*{donGia}" class="form-control" id="price">
					      <span class="text-danger" th:errors="*{donGia}"></span>
					    </div>
					</div>
					<div class="mb-3 row">
					    <label for="quantity" class="col-sm-2 col-form-label">Số Lượng</label>
					    <div class="col-sm-10">
					      <input type="number" min="0" th:field="*{soLuongTon}" class="form-control" id="quantity">
					      <span class="text-danger" th:errors="*{soLuongTon}"></span>
					    </div>
					</div>
					<div class="mb-3 row">
					    <label for="mytextarea" class="col-sm-2 col-form-label">Mô Tả</label>
					    <div class="col-sm-10">
					      <textarea rows="" cols="" th:field="*{moTa}" id="mytextarea"></textarea>
					      <span class="text-danger" th:errors="*{moTa}"></span>
					    </div>
					</div>
					<div class="mb-3 row">
					    <label for="category" class="col-sm-2 col-form-label">Thể Loại</label>
					    <div class="col-sm-10">
					      <select class="form-select" th:field="*{theLoai.maTheLoai}" id="category">
							<option th:each="tl : ${TheLoais}" th:value="${tl.maTheLoai}"
								th:text="${tl.tenTheLoai}"></option>
						</select>
					    </div>
					</div>
					<div class="mb-3 row">
					    <label for="nsx" class="col-sm-2 col-form-label">Nhà Sản Xuất</label>
					    <div class="col-sm-10">
					      <select class="form-select" th:field="*{nhaXuatBan.maNhaXuatBan}" id="nsx">
							<option th:each="nxb : ${NhaXuatBans}" th:value="${nxb.maNhaXuatBan}"
								th:text="${nxb.tenNhaXuatBan}"></option>
							</select>
					    </div>
					</div>
					<div class="mb-3 row">
					    <label for="nhommua" class="col-sm-2 col-form-label">Nhóm Mua</label>
					    <div class="col-sm-10">
					      <select class="form-select" th:field="*{nhomMua.maNhom}">
							<option th:each="nm : ${NhomMuas}" th:value="${nm.maNhom}"
								th:text="${nm.tenNhom}"></option>
						</select>
					    </div>
					</div>
					<div class="row">
						<label class="col-sm-2 col-form-label">Hình ảnh</label>
						<div class="card col-sm-10" style="border: none">
							<div class="card-header d-flex justify-content-between">
								<h4>Image Uploading</h4>
								<!-- <form class="form" action="#" method="post" id="form"> -->
								<input type="file" name="Image" id="image" multiple=""
									class="d-none" onchange="image_select()">
								<button class="btn btn-sm btn-primary" type="button"
									onclick="document.getElementById('image').click()">Choose
									Images</button>
								<!-- </form> -->
							</div>
							<div class="card-body d-flex flex-wrap justify-content-start"
								id="container-image">
								<!-- Image will be show here-->
							</div>
						</div>
						<span class="text-danger offset-2" th:errors="*{tenSach}"></span>
					</div>
					<div class="text-center">
					<input class="btn btn-primary" type="submit" value="Thêm mới">
					</div>
				</form>
</div>

<script>
	var images = [];
	const image_select = function () {
		document.getElementById('container-image').innerHTML ="";
		images = [];
		  var image = document.getElementById('image').files;
		  for (i = 0; i < 3; i++) {
		  	  if (image[i] !== undefined) {
	      		images.push({
		  	  	    "name" : image[i].name,
		  	  	    "url" : URL.createObjectURL(image[i]),
		  	  	    "file" : image[i],
		  	    })
		  	  } else 
		  	  {
		  	  	 break;
		  	  }
		  }
	
		  document.getElementById('form').reset();
		  document.getElementById('container-image').innerHTML = image_show();
	}
	
	
	function image_show() {
	var image = "";
	images.forEach((i) => {
	image += `<div class="image_container d-flex justify-content-center position-relative">
		  	  	  <img src="`+ i.url + `" alt="Image">
		  	  	  <span class="position-absolute" onclick="delete_image(`+ images.indexOf(i) + `)">&times;</span>
		  	  </div>`;
	})
	return image;
	}
	function delete_image(e) {
	images.splice(e, 1);
	document.getElementById('container-image').innerHTML = image_show();
	}
	function check_duplicate(name) {
		var image = true;
		if (images.length > 0) {
			for (e = 0; e < images.length; e++) {
				if (images[e].name == name) {
					image = false;
					break;
				}
			}
		}
		return image;
	}
	function get_image_data() {
		var form = new FormData()
		for (let index = 0; index < images.length; index++) {
		form.append("file[" + index + "]", images[index]['file']);
		}
		return form;
	} 
</script>
				<!-- <a th:href="@{'/danh-sach-san-pham'}">Quay Lại</a>  -->
			</div>
		</div>
	</section>
<<<<<<< HEAD
=======
	<!-- <div id="wrapper" style="margin-top: 20px;">
		<input id="fileUpload" name="imageFile" multiple="multiple" type="file" accept="image/*" />
		<div id="image-holder"></div>
	</div>

	<script>
		$(document).ready(function() {
	        $("#fileUpload").on('change', function() {
	          //Get count of selected files
	          var countFiles = $(this)[0].files.length;
	          var imgPath = $(this)[0].value;
	          var extn = imgPath.substring(imgPath.lastIndexOf('.') + 1).toLowerCase();
	          var image_holder = $("#image-holder");
	          image_holder.empty();
	          if (extn == "gif" || extn == "png" || extn == "jpg" || extn == "jpeg") {
	            if (typeof(FileReader) != "undefined") {
	              //loop for each file selected for uploaded.
	              for (var i = 0; i < countFiles; i++) 
	              {
	                var reader = new FileReader();
	                reader.onload = function(e) {
	                  $("<img />", {
	                    "src": e.target.result,
	                    "class": "thumb-image"
	                  }).appendTo(image_holder);
	                }
	                image_holder.show();
	                reader.readAsDataURL($(this)[0].files[i]);
	              }
	            } else {
	              alert("This browser does not support FileReader.");
	            }
	          } else {
	            alert("Pls select only images");
	          }
	        });
	      });
	</script> -->
	
	</script>
>>>>>>> 077bd355df12fa91e1f00464001cf197e7215f0d
	<script>
    tinymce.init({
      selector: 'textarea',
      plugins: 'advlist autolink lists link image charmap print preview hr anchor pagebreak',
      toolbar_mode: 'floating',
      entity_encoding : "raw",
      encoding: "UTF-8",
   });
  </script>
  
    <!--Script-->
  
</body>
</html>